<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boulier Rekenrek Interactif</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #222; /* Fond page gris fonc√© */
            font-family: 'Segoe UI', sans-serif;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* Pas de scroll */
        }

        /* Barre d'outils en bas */
        .controls {
            margin-top: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap; /* Pour petits √©crans si besoin */
            justify-content: center;
        }
        button {
            background-color: #2563eb; color: white; border: none; padding: 12px 24px;
            border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1.2rem;
            box-shadow: 0 4px 0 #1e40af;
            transition: transform 0.1s;
        }
        button:active { transform: translateY(4px); box-shadow: none; }
        
        /* Styles sp√©cifiques des boutons */
        button.reset { background-color: #dc2626; box-shadow: 0 4px 0 #991b1b; } /* Rouge */
        button.preset { background-color: #059669; box-shadow: 0 4px 0 #047857; } /* Vert */
        
        /* Zone d'affichage du total */
        #total-display {
            font-size: 2rem; color: #fbbf24; font-weight: bold;
            background: #111; padding: 5px 20px; border-radius: 8px; border: 1px solid #444;
            min-width: 80px; text-align: center;
            opacity: 0; transition: opacity 0.3s; /* Cach√© par d√©faut */
            display: flex; align-items: center; justify-content: center;
        }
        #total-display.visible { opacity: 1; }

        /* LE BOULIER */
        .rekenrek-board {
            /* Taille relative √† la hauteur de l'√©cran pour le projo */
            height: 80vh; 
            aspect-ratio: 1.6/1; /* Format paysage large */
            background-color: #111; /* FOND NOIR */
            
            /* CADRE BOIS √âPAIS */
            border-left: 25px solid #d2b48c;
            border-right: 25px solid #d2b48c;
            border-radius: 8px;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);

            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            padding: 10px 0;
            position: relative;
        }

        .row {
            position: relative;
            width: 100%;
            height: 9%; /* 10 lignes */
            display: flex;
            align-items: center;
            justify-content: space-between; /* Cl√© pour s√©parer GAUCHE / DROITE */
            padding: 0; /* Z√âRO MARGE : Les billes touchent le bois */
            box-sizing: border-box;
        }

        /* La tige */
        .wire {
            position: absolute;
            left: 0; right: 0; top: 50%;
            height: 4px; /* Plus √©pais pour l'√©cran */
            background-color: #9ca3af;
            z-index: 0;
            margin: 0 -2px; /* Pour entrer dans le bois */
        }

        /* Groupes de perles (Gauche / Droite) */
        .bead-group {
            display: flex;
            align-items: center;
            z-index: 1;
            height: 100%;
            transition: all 0.3s ease-out; /* Animation fluide */
        }
        
        /* Zone cliquable large pour faciliter la manipulation au doigt */
        .click-zone {
            cursor: pointer;
            padding: 5px 0; /* Z√âRO ESPACE horizontal entre les billes */
            transition: transform 0.1s;
        }
        .click-zone:hover { transform: scale(1.1); z-index: 10; }

        /* La perle visuelle */
        .bead {
            width: 4vh; height: 4vh; /* Taille responsive */
            border-radius: 50%;
            /* Volume conserv√© */
            box-shadow: inset -2px -2px 5px rgba(0,0,0,0.5), 2px 2px 5px rgba(255,255,255,0.2);
        }

        /* Couleurs */
        .bead.blue { background-color: #3b82f6; }
        .bead.red { background-color: #dc2626; }

    </style>
</head>
<body>

    <div class="rekenrek-board" id="board">
        </div>

    <div class="controls">
        <button onclick="resetBoard()" class="reset" title="Remettre √† z√©ro">0</button>
        <button onclick="set50()" class="preset" title="Remplir la moiti√© sup√©rieure">50</button>
        <button onclick="set100()" class="preset" title="Tout remplir">100</button>
        <button onclick="toggleCount()">üëÅÔ∏è Voir le nombre</button>
        <div id="total-display">0</div>
    </div>

    <script>
        const board = document.getElementById('board');
        const totalDisplay = document.getElementById('total-display');
        
        // √âtat du boulier : tableau de 10 entiers (nombre de perles √† GAUCHE pour chaque ligne)
        let state = Array(10).fill(0);

        // --- 1. INITIALISATION ---
        function init() {
            board.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                createRow(i);
            }
            updateTotal();
        }

        // --- 2. CR√âATION D'UNE LIGNE ---
        function createRow(rowIndex) {
            const row = document.createElement('div');
            row.className = 'row';

            // Tige
            const wire = document.createElement('div');
            wire.className = 'wire';
            row.appendChild(wire);

            // Groupe GAUCHE (Activ√©)
            const leftGroup = document.createElement('div');
            leftGroup.className = 'bead-group left-group';
            
            // Groupe DROITE (D√©sactiv√©)
            const rightGroup = document.createElement('div');
            rightGroup.className = 'bead-group right-group';

            // Nombre de perles actives actuellement
            const activeCount = state[rowIndex];

            // --- G√âN√âRATION DES 10 PERLES ---
            for (let beadIndex = 0; beadIndex < 10; beadIndex++) {
                // D√©terminer la couleur (Logique invers√©e √† 50)
                const colorClass = getBeadColor(rowIndex, beadIndex);
                
                // Cr√©er l'√©l√©ment perle
                const beadWrapper = document.createElement('div');
                beadWrapper.className = 'click-zone';
                
                const bead = document.createElement('div');
                bead.className = `bead ${colorClass}`;
                beadWrapper.appendChild(bead);

                // --- LOGIQUE D'INTERACTION ---
                if (beadIndex < activeCount) {
                    // Clic gauche -> retour droite
                    beadWrapper.onclick = () => updateRowState(rowIndex, beadIndex);
                    leftGroup.appendChild(beadWrapper);
                } else {
                    // Clic droite -> aller gauche
                    beadWrapper.onclick = () => updateRowState(rowIndex, beadIndex + 1);
                    rightGroup.appendChild(beadWrapper);
                }
            }

            row.appendChild(leftGroup);
            row.appendChild(rightGroup);
            board.appendChild(row);
        }

        // --- 3. LOGIQUE COULEURS ---
        function getBeadColor(rowIndex, beadIndex) {
            // Lignes 0-4 : 5 Bleues / 5 Rouges
            if (rowIndex < 5) {
                return beadIndex < 5 ? 'blue' : 'red';
            } 
            // Lignes 5-9 : 5 Rouges / 5 Bleues
            else {
                return beadIndex < 5 ? 'red' : 'blue';
            }
        }

        // --- 4. GESTION DE L'√âTAT ---
        function updateRowState(rowIndex, newValue) {
            state[rowIndex] = newValue;
            init(); 
        }

        // Remettre √† Z√©ro
        function resetBoard() {
            state = Array(10).fill(0);
            init();
        }

        // Mettre √† 50 (5 premi√®res lignes pleines)
        function set50() {
            for(let i=0; i<10; i++) {
                if(i < 5) state[i] = 10; // Lignes 0 √† 4 remplies
                else state[i] = 0;       // Lignes 5 √† 9 vides
            }
            init();
        }

        // Mettre √† 100 (Tout plein)
        function set100() {
            state = Array(10).fill(10);
            init();
        }

        function updateTotal() {
            const total = state.reduce((a, b) => a + b, 0);
            totalDisplay.textContent = total;
        }

        function toggleCount() {
            totalDisplay.classList.toggle('visible');
        }

        // Lancement
        init();

    </script>
</body>
</html>
